!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=e():t.WispNavigate=e()}("undefined"!=typeof window?window:this,(function(){class t{static config={navigationProgressBar:!0,navigationProgressBarColor:"#29d",navigationProgressBarHeight:"3px",enablePerformanceLogging:!1};static init(e={}){this.config={...this.config,...e},this.bindNavigation(),window.addEventListener("popstate",(()=>{this.navigate(window.location.pathname+window.location.search,{pushState:!1})}))}static bindNavigation(){document.querySelectorAll("a[wisp\\:navigate], a[wisp-navigate]").forEach((t=>{t.removeEventListener("click",this.handleNavigate),t.addEventListener("click",this.handleNavigate)}))}static handleNavigate=e=>{e.preventDefault();const t=e.currentTarget.getAttribute("href");t&&"#"!==t&&this.navigate(t)};static async navigate(t,e={pushState:!0}){const i=new CustomEvent("wisp:navigate-before",{cancelable:!0,detail:{url:t,options:e}});if(!document.dispatchEvent(i))return;try{const i=performance.now();document.dispatchEvent(new CustomEvent("wisp:navigate-start",{detail:{url:t,options:e}})),this.showNavigationProgressBar();const n=await fetch(t,{headers:{"X-Requested-With":"X-Wisp-Navigate",Accept:"text/html"}});if(!n.ok)throw new Error(`Navigation failed: ${n.status}`);const a=await n.text(),s=new DOMParser().parseFromString(a,"text/html");document.dispatchEvent(new CustomEvent("wisp:navigate-before-dom-update",{detail:{url:t,options:e,newDocument:s}}));const o=s.querySelector("#app"),r=document.querySelector("#app");o&&r?r.innerHTML=o.innerHTML:document.body.innerHTML=s.body.innerHTML,document.title=s.title,document.dispatchEvent(new CustomEvent("wisp:navigate-after-dom-update",{detail:{url:t,options:e}})),this.config.enablePerformanceLogging&&console.debug(`WispNavigate took ${(performance.now()-i).toFixed(2)}ms`),this.bindNavigation(),window.scrollTo(0,0),!1!==e.pushState&&window.history.pushState({},"",t),document.dispatchEvent(new CustomEvent("wisp:navigate-success",{detail:{url:t,options:e}}))}catch(i){console.error("Navigation error:",i),document.dispatchEvent(new CustomEvent("wisp:navigate-error",{detail:{url:t,options:e,error:i}})),window.location.href=t}finally{this.hideNavigationProgressBar(),document.dispatchEvent(new CustomEvent("wisp:navigate-complete",{detail:{url:t,options:e}}))}}static showNavigationProgressBar(){this.config.navigationProgressBar&&(this.injectNavigationProgressBar(),setTimeout((()=>{const t=document.getElementById("wisp-progress-bar");t&&(t.style.opacity="1",t.style.width="80%")}),10))}static hideNavigationProgressBar(){if(this.config.navigationProgressBar){const t=document.getElementById("wisp-progress-bar");t&&(t.style.width="100%",setTimeout((()=>{t.style.opacity="0",t.style.width="0"}),400))}}static injectNavigationProgressBar(){if(!document.getElementById("wisp-progress-bar")){const t=document.createElement("div");t.id="wisp-progress-bar";const e=this.config.navigationProgressBarColor||"#29d",i=this.config.navigationProgressBarHeight||"3px";t.style.cssText=`position:fixed;top:0;left:0;height:${i};width:0;background:${e};z-index:99999;transition:width 0.2s,opacity 0.4s;opacity:0;`,document.body.appendChild(t)}}}return document.addEventListener("DOMContentLoaded",(()=>t.init({navigationProgressBar:!0,navigationProgressBarColor:"#29d",navigationProgressBarHeight:"3px",enablePerformanceLogging:!0}))),t}));
